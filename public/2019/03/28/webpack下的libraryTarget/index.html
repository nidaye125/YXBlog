<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="前端匍匐前进">
    <meta name="keyword"  content="前端">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        webpack下的libraryTarget - ......
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> less code more art. </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <i>......</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/archive">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1简介"><span class="toc-text">1简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-传统方式：script标签"><span class="toc-text">1.1.传统方式：script标签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-AMD"><span class="toc-text">1.2.AMD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-commonjs-方式"><span class="toc-text">1.3.commonjs 方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-ES6-module"><span class="toc-text">1.4.ES6 module</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-output-library"><span class="toc-text">2.output.library</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-output-libraryTarget"><span class="toc-text">3.output.libraryTarget</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4分类"><span class="toc-text">4分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-暴露一个变量"><span class="toc-text">4.1 暴露一个变量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-1-libraryTarget-“var”-default"><span class="toc-text">4.1.1 libraryTarget: “var”- (default)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-2-libraryTarget-“assign”"><span class="toc-text">4.1.2 libraryTarget: “assign”</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-通过对象属性暴露"><span class="toc-text">4.2 通过对象属性暴露</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1libraryTarget-“this”"><span class="toc-text">4.2.1libraryTarget: “this”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-libraryTarget-“window”"><span class="toc-text">4.2.2 libraryTarget: “window”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-3-libraryTarget-“global”"><span class="toc-text">4.4.3 libraryTarget: “global”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-4-libraryTarget-“commonjs”"><span class="toc-text">4.4.4 libraryTarget: “commonjs”</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3模块定义系统"><span class="toc-text">4.3模块定义系统</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-1-libraryTarget-“commonjs2”"><span class="toc-text">4.3.1 libraryTarget: “commonjs2”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-libraryTarget-“umd”"><span class="toc-text">4.3.2 libraryTarget: “umd”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-3-libraryTarget-“amd”"><span class="toc-text">4.3.3 libraryTarget: “amd”</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-其他类型"><span class="toc-text">4.4 其他类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-1libraryTarget-“jsonp”"><span class="toc-text">4.4.1libraryTarget: “jsonp” -</span></a></li></ol></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>
        <div class="index-about-mobile">
            <i> less code more art. </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        webpack下的libraryTarget
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2019-03-28 19:59:42</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#模块化" title="模块化">模块化</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <p>output.library和output.libraryTarget属性可能大家都会比较陌生，因为一般如果只在项目中使用 webpack 不需要关注这两个属性，但是如果是开发类库，那么这两个属性就是必须了解的。</p>
<h2 id="1简介"><a href="#1简介" class="headerlink" title="1简介"></a>1简介</h2><p>回想一下，当我们引入别人开发的类库时有几种方式？下面假设我们引入一个demo方法：</p>
<h3 id="1-1-传统方式：script标签"><a href="#1-1-传统方式：script标签" class="headerlink" title="1.1.传统方式：script标签"></a>1.1.传统方式：script标签</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"demo.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">demo();</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="1-2-AMD"><a href="#1-2-AMD" class="headerlink" title="1.2.AMD"></a>1.2.AMD</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">define(['demo'], function(<span class="name">demo</span>) &#123;</span><br><span class="line">demo()<span class="comment">;</span></span><br><span class="line">&#125;)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<h3 id="1-3-commonjs-方式"><a href="#1-3-commonjs-方式" class="headerlink" title="1.3.commonjs 方式"></a>1.3.commonjs 方式</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> demo = <span class="built_in">require</span>(<span class="string">'demo'</span>);</span><br><span class="line">demo();</span><br></pre></td></tr></table></figure>
<h3 id="1-4-ES6-module"><a href="#1-4-ES6-module" class="headerlink" title="1.4.ES6 module"></a>1.4.ES6 module</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> demo <span class="keyword">from</span> <span class="string">'demo'</span>;</span><br><span class="line"></span><br><span class="line">demo();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>大家思考一下，为什么这个类库能支持不同方式的引入？如何实现的？这就是 webpack 配置output.library和output.libraryTarget提供的功能。</p>
</blockquote>
<h2 id="2-output-library"><a href="#2-output-library" class="headerlink" title="2.output.library"></a>2.output.library</h2><p>支持输入string或者object(从 webpack 3.1.0 版本开始支持; 限于 libraryTarget: “umd” 时使用)类型的值。<br><strong>output.library的值被如何使用会根据output.libraryTarget的取值不同而不同。</strong> 而默认output.libraryTarget的取值是var，如果如下配置：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">output</span>: &#123;</span><br><span class="line">  <span class="attribute">library</span>: <span class="string">"myDemo"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果在 HTML 页面中使用script标签引入打包结果文件，那么变量myDemo对应的值将会是入口文件(entry file)的返回值。</p>
<h2 id="3-output-libraryTarget"><a href="#3-output-libraryTarget" class="headerlink" title="3.output.libraryTarget"></a>3.output.libraryTarget</h2><p>支持输入string类型的值。默认值：var<br>此配置的作用是控制 webpack 打包的内容是如何暴露的。请注意这个选项需要和output.library所绑定的值一起产生作用。</p>
<p>++在以下的 demo 中，假设output.library值是myDemo。_entry_return_表示入口点返回的值。在bundle中，它是webpack从入口点生成的函数的输出。++</p>
<h2 id="4分类"><a href="#4分类" class="headerlink" title="4分类"></a>4分类</h2><h3 id="4-1-暴露一个变量"><a href="#4-1-暴露一个变量" class="headerlink" title="4.1 暴露一个变量"></a>4.1 暴露一个变量</h3><p>以下选项会把打包返回的值（无论暴露的是什么）<strong>绑定到一个由output.library指定的变量上</strong>，无论包是被如何引用。</p>
<h4 id="4-1-1-libraryTarget-“var”-default"><a href="#4-1-1-libraryTarget-“var”-default" class="headerlink" title="4.1.1 libraryTarget: “var”- (default)"></a>4.1.1 libraryTarget: “var”- (default)</h4><p>使用这个配置，当库被加载时，那么库的返回值会被分配到使用用var申明的变量上。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myDemo = _entry_return_;</span><br><span class="line"></span><br><span class="line"><span class="comment">// In a separate script...</span></span><br><span class="line">myDemo();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果没有设置output.library值，那么将不会发生赋值行为。<br>亲测：可以通过script标签音如，library挂载在window上</p>
</blockquote>
<h4 id="4-1-2-libraryTarget-“assign”"><a href="#4-1-2-libraryTarget-“assign”" class="headerlink" title="4.1.2 libraryTarget: “assign”"></a>4.1.2 libraryTarget: “assign”</h4><p>使用这个设置，会把库返回值分配给一个没使用var申明的变量中，如果这个变量没有在引入作用域中提前申明过，<strong>那么将会挂载在全局作用域中</strong>。（注意，这个行为有可能会覆盖全局作用域中的已有变量）</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">myDemo</span> = _entry_return_<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<h3 id="4-2-通过对象属性暴露"><a href="#4-2-通过对象属性暴露" class="headerlink" title="4.2 通过对象属性暴露"></a>4.2 通过对象属性暴露</h3><p>以下选项将库的返回值（无论返回值是什么）分配给特定对象的指定属性，属性由output.library指定，对象由output.libraryTarget指定。</p>
<p>当output.library没有指定为非空字符串，那么默认行为是将库返回值的所有属性(properties)都分配到对象中，代码如下：</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">function</span>(<span class="name">e</span>, a) &#123; for(<span class="name">var</span> i in a) e[<span class="name">i</span>] = a[<span class="name">i</span>]<span class="comment">; &#125;($&#123;output.libraryTarget&#125;, _entry_return_)</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意，发生这个行为的时候 webpack 并不会检查对象中是否已经存在这些属性值，也就是会发生覆盖行为。</p>
</blockquote>
<h4 id="4-2-1libraryTarget-“this”"><a href="#4-2-1libraryTarget-“this”" class="headerlink" title="4.2.1libraryTarget: “this”"></a>4.2.1libraryTarget: “this”</h4><blockquote>
<p>将库的返回值分配给this对象的由output.library指定的属性。其中this的意义由用户决定。</p>
</blockquote>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>[<span class="string">"myDemo"</span>] = _entry_return_;</span><br><span class="line"><span class="regexp">//</span>使用时</span><br><span class="line"><span class="keyword">this</span>.myDemo();</span><br><span class="line">或者</span><br><span class="line">myDemo(); <span class="regexp">//</span> <span class="keyword">if</span> <span class="keyword">this</span> <span class="keyword">is</span> <span class="built_in">window</span></span><br></pre></td></tr></table></figure>
<h4 id="4-2-2-libraryTarget-“window”"><a href="#4-2-2-libraryTarget-“window”" class="headerlink" title="4.2.2 libraryTarget: “window”"></a>4.2.2 libraryTarget: “window”</h4><blockquote>
<p>将库的返回值分配给window对象的由output.library指定的属性。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>[<span class="string">"myDemo"</span>] = _entry_return_;</span><br><span class="line"><span class="comment">//使用时</span></span><br><span class="line"><span class="built_in">window</span>.myDemo.doSomething();</span><br></pre></td></tr></table></figure>
<h4 id="4-4-3-libraryTarget-“global”"><a href="#4-4-3-libraryTarget-“global”" class="headerlink" title="4.4.3 libraryTarget: “global”"></a>4.4.3 libraryTarget: “global”</h4><blockquote>
<p>将库的返回值分配给global对象的由output.library指定的属性。</p>
</blockquote>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">global</span>[<span class="string">"myDemo"</span>] = _entry_return_;</span><br><span class="line"><span class="comment">//使用时</span></span><br><span class="line"><span class="keyword">global</span>.myDemo();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>实际经测试与window是一样的，不会出现global</p>
</blockquote>
<h4 id="4-4-4-libraryTarget-“commonjs”"><a href="#4-4-4-libraryTarget-“commonjs”" class="headerlink" title="4.4.4 libraryTarget: “commonjs”"></a>4.4.4 libraryTarget: “commonjs”</h4><blockquote>
<p>将库的返回值分配给exports对象的由output.library指定的属性。正如名字所指，这个选项可以使用在 CommonJS 环境。</p>
</blockquote>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">exports[<span class="string">"myDemo"</span>] = _entry_return_<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">require(<span class="string">"myDemo"</span>).doSomething()<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>myDemo是webpack中library的值</p>
</blockquote>
<h3 id="4-3模块定义系统"><a href="#4-3模块定义系统" class="headerlink" title="4.3模块定义系统"></a>4.3模块定义系统</h3><p>以下选项将产生一个包含更完整兼容代码的包，以确保与各种模块系统的兼容性。 此时output.library选项在不同的output.libraryTarget选项下具有不同的含义。</p>
<h4 id="4-3-1-libraryTarget-“commonjs2”"><a href="#4-3-1-libraryTarget-“commonjs2”" class="headerlink" title="4.3.1 libraryTarget: “commonjs2”"></a>4.3.1 libraryTarget: “commonjs2”</h4><blockquote>
<p>将库的返回值分配给module.exports。正如名字所指，这个选项可以使用在 CommonJS 环境。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//实际的代码</span></span><br><span class="line"><span class="built_in">module</span>.exports = _entry_return_;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用</span></span><br><span class="line"><span class="keyword">const</span> myDemo = <span class="built_in">require</span>(<span class="string">"myDemo"</span>);</span><br><span class="line">myDemo();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意，在这个情况下output.library不是必须的，因为此时output.library选项将会被忽略。</p>
<p>有没有注意到 CommonJS 和 CommonJS2 长的非常像？他们确实很相似，但是其中有微妙的区别，想了解更多可以参考这个issue</p>
</blockquote>
<blockquote>
<p>注意：如果使用的方式不对，如不是require进来的，会报错module is not defined</p>
</blockquote>
<h4 id="4-3-2-libraryTarget-“umd”"><a href="#4-3-2-libraryTarget-“umd”" class="headerlink" title="4.3.2 libraryTarget: “umd”"></a>4.3.2 libraryTarget: “umd”</h4><blockquote>
<p>这个选项会尝试把库暴露给前使用的模块定义系统，这使其和CommonJS、AMD兼容或者暴露为全局变量。 </p>
</blockquote>
<blockquote>
<p><strong>umd打出来的包，commonjs amd规范下可以使用，或者暴露成全局变量挂载window上，详情看最下面</strong></p>
</blockquote>
<p><strong>output.library 选项在这里是必须的。</strong></p>
<p>最终代码输出如下：</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">function</span> webpackUniversalModuleDefinition(<span class="name">root</span>, factory) &#123;</span><br><span class="line">if(<span class="name">typeof</span> exports === <span class="symbol">'object</span>' &amp;&amp; typeof module === <span class="symbol">'object</span>')</span><br><span class="line">  module.exports = factory()<span class="comment">;</span></span><br><span class="line">else if(<span class="name">typeof</span> define === <span class="symbol">'function</span>' &amp;&amp; define.amd)</span><br><span class="line">  define([], factory)<span class="comment">;</span></span><br><span class="line">else if(<span class="name">typeof</span> exports === <span class="symbol">'object</span>')</span><br><span class="line">  exports[<span class="string">"MyLibrary"</span>] = factory()<span class="comment">;</span></span><br><span class="line">else</span><br><span class="line">  root[<span class="string">"MyLibrary"</span>] = factory()<span class="comment">;</span></span><br><span class="line">&#125;)(<span class="name">typeof</span> self !== <span class="symbol">'undefined</span>' ? self : this, function() &#123;</span><br><span class="line">return _entry_return_<span class="comment">;</span></span><br><span class="line">&#125;)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>如果 output.library 没有输入有效值，那么对于全局变量的处理会和上面提到的 暴露一个变量 一致。代码输出如下：</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(<span class="name">function</span> webpackUniversalModuleDefinition(<span class="name">root</span>, factory) &#123;</span><br><span class="line">if(<span class="name">typeof</span> exports === <span class="symbol">'object</span>' &amp;&amp; typeof module === <span class="symbol">'object</span>')</span><br><span class="line">  module.exports = factory()<span class="comment">;</span></span><br><span class="line">else if(<span class="name">typeof</span> define === <span class="symbol">'function</span>' &amp;&amp; define.amd)</span><br><span class="line">  define([], factory)<span class="comment">;</span></span><br><span class="line">else &#123;</span><br><span class="line">  var a = factory()<span class="comment">;</span></span><br><span class="line">  for(<span class="name">var</span> i in a) (<span class="name">typeof</span> exports === <span class="symbol">'object</span>' ? exports : root)[<span class="name">i</span>] = a[<span class="name">i</span>]<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;)(<span class="name">this</span>, function() &#123;</span><br><span class="line">return _entry_return_<span class="comment">;</span></span><br><span class="line">&#125;)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>从 webpack 3.10.0 版本开始，我们可以通过把 output.library 定义为对象来控制不同目标环境的输出值。详情可参考这个Demo</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">output:</span> &#123;</span><br><span class="line"><span class="symbol">library:</span> &#123;</span><br><span class="line"><span class="symbol">  root:</span> <span class="string">"myDemo"</span>,</span><br><span class="line"><span class="symbol">  amd:</span> <span class="string">"my-demo"</span>,</span><br><span class="line"><span class="symbol">  commonjs:</span> <span class="string">"my-common-demo"</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="symbol">libraryTarget:</span> <span class="string">"umd"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-3-3-libraryTarget-“amd”"><a href="#4-3-3-libraryTarget-“amd”" class="headerlink" title="4.3.3 libraryTarget: “amd”"></a>4.3.3 libraryTarget: “amd”</h4><blockquote>
<p>这个选项会把库作为 AMD 模块导出。 </p>
</blockquote>
<p>AMD模块要求输入脚本（例如由 <code>&lt;script&gt;</code>标签加载的第一个脚本）被定义为具有特定属性，例如通常由 RequireJS 或任何兼容的加载器（诸如almond）提供的require和define属性。<strong>否则，直接加载生成的 AMD 捆绑包将导致类似define is not defined的错误。<br>由此定义生成的代码会如下：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="string">"myDemo"</span>, [], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> _entry_return_;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>以上的代码可以作为script标签引入代码的一部分被包含，然后在通过以下代码调用：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>([<span class="string">'myDemo'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">myDemo</span>) </span>&#123;</span><br><span class="line"><span class="comment">// Do something with the library...</span></span><br><span class="line">myDemo();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>如果output.library没有定义有效值，那么生成的代码将如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">define([], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> _entry_return_;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>如果直接使用<code>&lt;script&gt;</code>标签加载，该库将无法按预期生效，或者根本无法生效（在 almond 加载器的情况下）。它只能通过与 RequireJS 兼容的异步模块加载器通过该文件的实际路径进行引入，因此在这种情况下，如果这些由服务器直接提供，那么output.path和output.filename配置可能变得非常重要。</p>
<blockquote>
<p><strong>非常重要的一件事情那就是umd和amd配置，打出来的包都可以共amd使用，换句话说可以让requirejs使用</strong></p>
</blockquote>
<h3 id="4-4-其他类型"><a href="#4-4-其他类型" class="headerlink" title="4.4 其他类型"></a>4.4 其他类型</h3><h4 id="4-4-1libraryTarget-“jsonp”"><a href="#4-4-1libraryTarget-“jsonp”" class="headerlink" title="4.4.1libraryTarget: “jsonp” -"></a>4.4.1libraryTarget: “jsonp” -</h4><blockquote>
<p>这个方法会使用 jsonp 的方式把结果包裹起来。<br>js </p>
</blockquote>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myDemo(<span class="name">_entry_return_</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>库的依赖由 externals 定义。</p>

        
            <div class="donate-container">
    <div class="donate-button">
        <button id="donate-button">赞赏</button>
    </div>
    <div class="donate-img-container hide" id="donate-img-container">
        <img id="donate-img" src="" data-src="/img/donate.jpg">
        <p> 感谢鼓励 </p>
    </div>
</div>
        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>
    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
